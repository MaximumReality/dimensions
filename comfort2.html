<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  
  <title>Maximum Reality: Comfort</title>
  <meta name="description" content="Maximum Reality: Comfort ‚Äî a relaxed neon cyber arcade experience. Dodge obstacles, collect loot, and enjoy a calmer reality.">

  <!-- Favicon & Touch Icons -->
  <link rel="icon" type="image/png" sizes="16x16" href="https://maximumreality.github.io/dimensions/Banner-40.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://maximumreality.github.io/dimensions/Banner-40.png">
  <link rel="icon" type="image/png" sizes="48x48" href="https://maximumreality.github.io/dimensions/Banner-40.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://maximumreality.github.io/dimensions/Banner-40.png">

  <!-- Manifest for PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Style / Animations -->
  <style>
    body, html {
      margin:0; padding:0; width:100%; height:100%; overflow:hidden;
      background:#000; -webkit-user-select:none; touch-action:none;
      font-family: 'Courier New', monospace;
    }
    #gameCanvas { display:block; width:100vw; height:100vh; background:#000; }

    .ui-layer { position: absolute; top: env(safe-area-inset-top); left: 20px;
      color: #0ff; z-index: 100; pointer-events: none; text-shadow: 0 0 8px #0ff; }
    #score { font-size: 24px; font-weight: bold; }
    #highScore { font-size: 14px; opacity: 0.8; margin-top: 5px; }
    #status { font-size: 16px; margin-top: 8px; }
    #invincible { font-size: 12px; opacity: 0.6; margin-top: 4px; color: #ff0; }

    .controls { position: absolute; top: calc(env(safe-area-inset-top) + 30px); right: 20px;
      display: flex; gap: 15px; z-index: 150; }
    .btn { font-size: 24px; background: rgba(0,255,255,0.15); border: 1.5px solid #0ff;
      border-radius: 8px; padding: 8px 12px; color: #0ff; cursor: pointer;
      backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center;
      user-select: none; touch-action: manipulation; }

    #bsod { position: fixed; inset: 0; background: #0000aa; color: #fff;
      font-family: 'Courier New'; display: none; z-index: 200; padding: 50px; text-align: center; }

    #flash { position: fixed; inset: 0; background: #fff; opacity: 0; z-index: 250;
      pointer-events: none; transition: opacity 0.1s; }

    #startOverlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.85); 
      color: #0ff; z-index: 300; display: flex; 
      align-items: center; justify-content: center;
      pointer-events: auto !important;
    }

    #hardModeBtn { text-shadow: 0 0 10px #f0f; animation: pulse 1.5s infinite; }
    #easyModeBtn { text-shadow: 0 0 10px #0ff; }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>

<div id="bsod">
  <h1>:(</h1>
  <p>CRITICAL DIMENSION ERROR</p>
  <p>REBOOTING SIMULATION...</p>
</div>

<div id="flash"></div>

<div id="startOverlay">
  <div style="text-align: center;">
    <div style="font-size: 32px; margin-bottom: 30px;">COMFORT REALITY</div>
    <div style="display: flex; gap: 20px; justify-content: center;">
      <div id="hardModeBtn" class="btn" style="font-size: 20px; padding: 20px; border-color: #f0f; color: #f0f; pointer-events: auto;">CHAOS</div>
      
      <div id="easyModeBtn" class="btn" style="font-size: 20px; padding: 20px; border-color: #0ff; color: #0ff; pointer-events: auto;">COMFORT</div>
    </div>
  </div>
</div>


<div class="controls">
  <a href="https://maximumreality.xyz" class="btn">üè†</a>
  <div id="muteBtn"  class="btn">üîä</div>
  <div id="pauseBtn" class="btn">‚èØÔ∏è</div>
</div>

<div class="ui-layer">
  <div id="score">DIMENSION: 0</div>
  <div id="highScore">BEST: 0</div>
  <div id="status">ZONE: CYBER</div>
  <div id="invincible"></div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
//  CORE & UI RECOVERY
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const canvas = document.getElementById('gameCanvas');
const ctx    = canvas.getContext('2d');

const bgMusic = new Audio('password-infinity.mp3'); bgMusic.loop = true;
const beastModeSfx = new Audio('beast_mode.mp3');

let isMuted = false, isPaused = false, gameState = 'START';
let score = 0, highScore = Number(localStorage.getItem('maxRealityHighScore')) || 0;
let frame = 0, gameSpeed = 4.5, dimensionHue = 0, shake = 0;
let jumpHeight = 0, yVelocity = 0, jumpsUsed = 0;
let currentZone = 'CYBER', portalActive = false, lastPortalScore = 0, invincibleFrames = 0;

const gravity = 1.4, GROUND_Y_OFFSET = 100;
let floorY;

// UI LISTENERS
document.getElementById('muteBtn').onclick = (e) => { e.stopPropagation(); isMuted = !isMuted; bgMusic.muted = isMuted; document.getElementById('muteBtn').innerText = isMuted ? 'üîá' : 'üîä'; };
document.getElementById('pauseBtn').onclick = (e) => { e.stopPropagation(); isPaused = !isPaused; };

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
//  ASSETS (RESTORED ALL LISTS)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const ASSETS = {
  bg: 'gg-bg.png', snackBg: 'hot-food-c-store-wp.JPG', earthquakeBg: 'pompeii-bg.png',
  floor: 'floor.png', loriBlur: 'lori-blur.png', portal: 'snack-portal.png', pc: 'old-pc.png',
  azul: ['Azul-doll.png','Azul-doll2.png','Azul-doll3.png','Azul-doll4.png'],
  buildings: ['building-a.png','building-b.png','building-c.png']
};

const CYBER_LOOT = ['2tb.png','card.png','circuitpython.png','core-i7.png','core-i9.png','graphics-card.png','motherboard.png','ram.png','ssd.png'];
const SNACK_LOOT = ['azulo_blueberry_vanilla.jpg','bread-slice.png','chips.png','hotdog.png','mochkil-burger.png','pink-donut.png','soda.png','taco.png'];

const imgCache = {azul:[], buildings:[], CYBER_LOOT:[], SNACK_LOOT:[]};

function loadAssets() {
  Object.keys(ASSETS).forEach(k => { if(!Array.isArray(ASSETS[k])) { const i=new Image(); i.src=ASSETS[k]; imgCache[k]=i; }});
  ASSETS.azul.forEach(src=>{const i=new Image(); i.src=src; imgCache.azul.push(i);});
  ASSETS.buildings.forEach(src=>{const i=new Image(); i.src=src; imgCache.buildings.push(i);});
  CYBER_LOOT.forEach(src=>{const i=new Image(); i.src=src; imgCache.CYBER_LOOT.push(i);});
  SNACK_LOOT.forEach(src=>{const i=new Image(); i.src=src; imgCache.SNACK_LOOT.push(i);});
}
loadAssets();

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
//  SPAWN LOGIC (LOOT & OBSTACLES)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let gameObjects = [];
function spawn() {
  const lastObj = gameObjects[gameObjects.length - 1];
  if (lastObj && lastObj.x > canvas.width - 400) return;

  if (score >= 5000 && score - lastPortalScore >= 5000 && !portalActive) {
    portalActive = true; lastPortalScore = score;
    gameObjects.push({x:canvas.width+100, y:floorY-180, w:140, h:180, type:'portal', img:imgCache.portal});
  } 
  else if (frame % 200 === 0) { // Spawn Computer
    gameObjects.push({x:canvas.width+100, y:floorY-75, w:85, h:75, type:'obstacle', img:imgCache.pc});
  } 
  else if (frame % 130 === 0) { // Spawn Loot
    let lootArr = (currentZone === 'CYBER') ? imgCache.CYBER_LOOT : imgCache.SNACK_LOOT;
    const lootImg = lootArr[Math.floor(Math.random()*lootArr.length)];
    if(lootImg) gameObjects.push({x:canvas.width+100, y:floorY-85, w:80, h:80, type:'tech', img:lootImg});
  }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
//  MAIN LOOP
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let drops = [];
function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; floorY = canvas.height - GROUND_Y_OFFSET; drops = Array(Math.floor(canvas.width / 20)).fill(1); }
resize(); window.addEventListener('resize', resize);

function loop() {
  if (isPaused || gameState !== 'PLAYING') { requestAnimationFrame(loop); return; }
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Backgrounds
  ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
  if (imgCache.bg?.complete) ctx.drawImage(imgCache.bg, 0, 0, canvas.width, canvas.height);

  frame++; if (invincibleFrames > 0) invincibleFrames--;
  spawn();

  // Physics with Ceiling Cap
  jumpHeight -= yVelocity; yVelocity += gravity;
  if (jumpHeight <= 0) { jumpHeight = 0; yVelocity = 0; jumpsUsed = 0; }
  if (jumpHeight > canvas.height - 250) { jumpHeight = canvas.height - 250; yVelocity = 0; }

  // Draw Azul (Tall)
  const anim = Math.floor(frame / 7) % 4;
  if (imgCache.azul[anim]) ctx.drawImage(imgCache.azul[anim], 100, floorY - 170 - jumpHeight, 110, 175);

  // Hitbox & Collision
  const pBox = { x: 125, y: floorY - 160 - jumpHeight, w: 60, h: 150 };

  for (let i = gameObjects.length - 1; i >= 0; i--) {
    const obj = gameObjects[i]; obj.x -= gameSpeed;
    ctx.drawImage(obj.img, obj.x, obj.y, obj.w, obj.h);

    if (pBox.x < obj.x + obj.w - 15 && pBox.x + pBox.w > obj.x + 15 && pBox.y < obj.y + obj.h - 15 && pBox.y + pBox.h > obj.y + 15) {
      if (obj.type === 'tech') { score += 100; dimensionHue += 2; gameObjects.splice(i, 1); }
      else if (obj.type === 'obstacle' && invincibleFrames <= 0) { 
        gameState = 'START'; document.getElementById('startOverlay').style.display = 'flex'; 
      }
      else if (obj.type === 'portal') { invincibleFrames = 180; portalActive = false; gameObjects = []; currentZone = (currentZone === 'CYBER' ? 'SNACK' : 'CYBER'); }
    }
    if (obj.x < -200) gameObjects.splice(i, 1);
  }
  
  document.getElementById('score').innerText = `DIMENSION: ${score}`;
  requestAnimationFrame(loop);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
//  INPUT
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.addEventListener('touchstart', e => {
  if (gameState === 'PLAYING' && jumpsUsed < 2 && !e.target.closest('.btn')) {
    yVelocity = -28; jumpsUsed++; e.preventDefault();
  }
}, {passive: false});

document.getElementById('easyModeBtn').onclick = () => {
  gameState = 'PLAYING'; document.getElementById('startOverlay').style.display = 'none';
  score = 0; frame = 0; jumpHeight = 0; yVelocity = 0; gameObjects = []; 
  bgMusic.play();
};
loop();
</script>


</body>
</html>
